"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.readingTimePlugin = void 0;
const reading_time_1 = require("./reading-time");
const pagePathRegex = (paths, page) => {
    const match = paths &&
        paths.some((p) => {
            const testRegex = new RegExp(p);
            return testRegex.test(page);
        });
    return match;
};
const readingTimePlugin = (options = {}) => ({
    name: "@renovamen/vuepress-plugin-reading-time",
    extendsPage: (page) => {
        if (!page.content)
            return;
        if (page.frontmatter && page.frontmatter.readingTime) {
            page.data.readingTime = page.frontmatter.readingTime;
        }
        if (options.includes && options.includes.length > 0) {
            // `options.includes` is specified, ignores `options.excludes`
            const includePage = pagePathRegex(options.includes, page.path);
            if (!includePage)
                return;
        }
        else {
            // `options.includes` is not specified
            const excludePage = pagePathRegex(options.excludes, page.path);
            if (excludePage)
                return;
        }
        page.data.readingTime = (0, reading_time_1.readingTime)(page.content, options);
    }
});
exports.readingTimePlugin = readingTimePlugin;
